<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Desarrollo de plugins · Shell Sentinel</title>
    <meta
      name="description"
      content="Extiende Shell Sentinel con plugins personalizados: ciclo de vida, estructura, localización, pruebas y distribución."
    />
    <link rel="canonical" href="https://www.shellsentinel.net/manuals/plugin-development-es.html" />
    <link rel="alternate" hreflang="x-default" href="https://www.shellsentinel.net/manuals/plugin-development-en.html" />
    <link rel="alternate" hreflang="en" href="https://www.shellsentinel.net/manuals/plugin-development-en.html" />
    <link rel="alternate" hreflang="es" href="https://www.shellsentinel.net/manuals/plugin-development-es.html" />
    <link rel="alternate" hreflang="de" href="https://www.shellsentinel.net/manuals/plugin-development-de.html" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="preload" href="../assets/css/styles.css" as="style" />
    <link rel="preload" href="../assets/css/manuals.css" as="style" />
    <link rel="stylesheet" href="../assets/css/styles.css" />
    <link rel="stylesheet" href="../assets/css/manuals.css" />
    <link rel="icon" href="../assets/img/favicon.svg" type="image/svg+xml" />
  </head>
  <body class="manual">
    <div class="manual-wrapper">
      <header class="manual-header">
        <div class="breadcrumb">
          <a href="../docs.html">&larr; Volver a la documentación</a>
          <span>/ Desarrollo de plugins (ES)</span>
        </div>
      </header>

      <main class="manual-content">
        <h1>Desarrollo de plugins — Shell Sentinel</h1>

        <h2>Visión general</h2>
        <p>
          Los plugins permiten moldear los flujos de trabajo, exponer guías internas y añadir
          integraciones que se sienten nativas dentro de la TUI. Cada módulo Python colocado en el
          directorio configurado <code>plugins/</code> se carga en el arranque, así que puedes iterar
          sin modificar la distribución principal.
        </p>

        <h2>Ciclo de vida resumido</h2>
        <ol>
          <li>Crea un módulo en <code>plugins/</code> (ruta por defecto) o en la carpeta apuntada por <code>SMART_AI_SYS_ADMIN_PLUGINS_DIR</code>.</li>
          <li>Expón <code>register(registry)</code>. La TUI la invoca una vez tras iniciar la interfaz.</li>
          <li>Desde ese punto registra comandos slash, traducciones, sugerencias de autocompletado y logging.</li>
          <li>Reinicia la aplicación para recargar el plugin mientras iteras en local.</li>
        </ol>

        <h2>Plantilla de comando inicial</h2>
        <p>El siguiente ejemplo ilustra la estructura mínima de un comando conversacional:</p>
        <pre><code class="language-python"># plugins/status_report.py
from smart_ai_sys_admin.plugins import PluginRegistry, PluginSlashCommand


def _server_report(args: list[str]) -> str:
    target = args[0] if args else "default"
    return (
        f"### Estado de `{target}`\n"
        "- Tareas pendientes: 3\n"
        "- Último backup: 2025-10-06\n"
        "- Contacto de guardia: infra@contoso.com"
    )


def register(registry: PluginRegistry) -> None:
    registry.register_translations(
        "es",
        {"plugins": {"status_report": {"description": "Resumen rápido de estado"}}},
    )
    registry.register_command(
        PluginSlashCommand(
            name="/status_report",
            aliases=("/estadoreporte",),
            handler=_server_report,
            description_key="plugins.status_report.description",
        )
    )
</code></pre>
        <p>
          Los handlers devuelven Markdown que se renderiza en el panel de conversación. Cualquier
          excepción queda registrada mediante el logger <code>smart_ai_sys_admin.plugins</code>, así que
          procura incluir mensajes accionables y pasos de recuperación cuando sea posible.
        </p>

        <h2>Localización y experiencia</h2>
        <ul>
          <li>Invoca <code>register_translations(locale, payload)</code> para cada idioma; la aplicación selecciona la versión correcta según el locale activo.</li>
          <li>Define un callback <code>suggestion</code> si quieres personalizar el autocompletado que aparece bajo el campo de entrada.</li>
          <li>Opta por Markdown conciso y resalta acciones destructivas o irreversibles antes de ejecutarlas.</li>
        </ul>

        <h2>Pruebas y observabilidad</h2>
        <ul>
          <li>Crea pruebas unitarias o scripts ligeros para validar los handlers sin lanzar la TUI.</li>
          <li>Activa logging detallado con <code>SMART_AI_SYS_ADMIN_LOG_LEVEL=DEBUG</code> mientras iteras.</li>
          <li>Si un plugin falla al cargar, revisa <code>logs/app.log</code> y ejecuta <code>/status</code> para confirmar el registro del comando.</li>
        </ul>

        <h2>Empaquetado y distribución</h2>
        <p>
          Empaqueta los plugins junto a los artefactos de despliegue o publícalos en un índice interno.
          Shell Sentinel carga cualquier módulo disponible en la ruta de plugins, así que documenta
          requisitos (claves API, variables de entorno, endpoints) y define pasos de rollback para que
          el equipo de operaciones pueda desactivar la extensión rápidamente.
        </p>
      </main>

      <footer class="manual-footer">
        © 2025 Shell Sentinel. Mantén este manual actualizado conforme evolucionen las capacidades de plugins.
      </footer>
    </div>
  </body>
</html>
